---
alwaysApply: true
---
ControlAI Project Rules: Quality and Strategy Standards

Our Guide: This document establishes the rules and best practices for developing ControlAI. It is your reference for maintaining consistency, security, and performance while working in harmony with AI (Cursor).

You are an expert in TypeScript, Node.js, Vite/React, HubSpot APIs, Shadcn UI, Radix UI, and Tailwind CSS.

---

## 1. Project Organization & Architecture

Use a logical directory structure, grouping files by domain (e.g., `src/features/forms`, `src/features/landing-pages`).

Use the `src/lib/` directory for low-level logic, such as HubSpot API helpers, data mappers, and third-party utilities.

For global or highly reusable components, use `src/components/`.

Keep the architecture simple and portable to ensure easy integration into HubSpot CMS pages or custom modules.

---

## 2. HubSpot Data & API Integration

All interactions with HubSpot data (CRM objects, forms, properties, workflows) must be abstracted through helper functions or service layers.

Never place complex or sensitive data logic directly inside React components.

Use HubSpot APIs (REST or Forms API) through controlled helper functions located in `src/lib/`.

Environment-specific configurations (API keys, portals, endpoints) must be separated and managed via environment variables.

Never hardcode HubSpot credentials or private tokens in client-side code.

---

## 3. Code Style and Structure

Write concise, technical TypeScript with clear examples for the AI (Cursor).

Use comments to explain complex technical concepts and non-obvious logic, facilitating AI understanding.

Prefer functional and declarative patterns in React.

Avoid code duplication by using helper functions and modular components.

Use descriptive variable names with auxiliary verbs (e.g., `isLoading`, `hasError`).

A component’s file structure should follow:
main exported component → subcomponents → helpers → statics → types.

---

## 4. Naming Conventions

Use lowercase letters with hyphens for directories (e.g., `src/components/form-wizard`).

Use named exports for React components and functions.

Prefer interfaces for defining object types and props.

Avoid enums; use literal objects or string unions whenever possible.

---

## 5. TypeScript Usage

All code must be written in TypeScript.

Prefer interfaces for component props and data models.

Use functional components with clearly typed props.

Avoid using `any`; use `unknown` or explicit types when typing is not obvious.

---

## 6. UI and Styling

Use Shadcn UI (based on Radix UI) for interface components.

Use Tailwind CSS for layout, spacing, and utility styles.

Develop mobile-first and ensure the design is responsive by default.

Use Tailwind CSS `dark:` variants to support dark mode when applicable.

---

## 7. Performance Optimization

Minimize unnecessary use of `useEffect` and `useState` to reduce re-renders.

Lazy-load non-critical components to improve initial load time.

Optimize images: prefer modern formats like WebP/AVIF, include width/height, and use lazy loading.

Avoid unnecessary abstraction that could impact performance or readability.

---

## 8. State Management

Prefer local component state (`useState`, `useReducer`) for most cases.

For global state (UI preferences, simple app-wide flags), consider lightweight solutions or the React Context API.

Avoid complex state management libraries unless there is a proven and explicit need.

---

## 9. Linting and Code Quality

Use ESLint, Prettier, and TypeScript in strict mode.

Validate all data inputs (forms, API payloads) with Zod or a similar library.

Ensure consistent formatting and predictable code structure.

---

## 10. Developer Experience (DX)

The `pnpm dev` command must start the development environment without TypeScript or linter errors.

Document important architecture and code decisions in `README.md` or in `docs/` directories.

Prioritize clarity and maintainability over cleverness.

---

## 11. Accessibility and UX

Use accessible primitives from Radix UI and components from Shadcn UI.

Ensure correct use of `aria-*` attributes, proper focus handling, and full keyboard support.

Maintain consistent spacing and typography for a high-quality user experience.

---

## 12. Security (HubSpot Context)

Environment Variables:
Never expose private HubSpot tokens or secrets in browser code.
All private keys must be stored in environment variables and used only in controlled environments (build time or server-side proxies).

Client-Side Safety:
Assume all React code may run in a public environment (HubSpot CMS).
Never trust client-side validation alone.

API Access:
Use private HubSpot APIs only through secure server-side or proxy layers.
Client-side code may only interact with public endpoints or HubSpot Forms embeds.

Data Exposure Limitation:
Return and handle only the strictly necessary fields from HubSpot APIs.

Input Validation:
Validate all user inputs and API payloads with Zod or equivalent schemas.

---

## Key Changes

Removal of all Supabase-related concepts (RLS, Edge Functions, Auth).

Focus on HubSpot CRM, Forms, and CMS-compatible data access patterns.

Adaptation of architecture and security rules to a client-side–first, HubSpot-friendly React environment.

Increased emphasis on portability, simplicity, and safe public execution.
